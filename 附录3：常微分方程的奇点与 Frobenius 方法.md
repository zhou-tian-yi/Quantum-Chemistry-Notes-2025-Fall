# 附录3：常微分方程的奇点与 Frobenius 方法

## A3.1 引言：微分方程的级数解法

在正文中，我们通过求解定态薛定谔方程遇到了几个关键的二阶常微分方程（ODE），例如：
1.  **一维谐振子**，导致了 **Hermite 方程** (厄米方程)。
2.  **刚性转子**，导致了 **Legendre 方程** (勒让德方程)。
3.  **氢原子**径向方程，将导致 **Laguerre 方程** (拉盖尔方程)。

我们在第4.2.1节 中使用了级数解法 $y = \sum a_n x^n$ 来求解厄米方程。这种标准幂级数（泰勒级数）解法，其有效性的前提是方程的系数在展开点（例如 $x=0$）是“行为良好”的（即解析的）。

然而，我们关心的其他方程在某些关键点上并不满足这个“良好”条件。例如，勒让德方程（标准化后）的系数 $p(x) = \frac{-2x}{1-x^2}$ 和 $q(x) = \frac{l(l+1)}{1-x^2}$ 在 $x=\pm 1$ 处是发散的。在这些点上，标准的幂级数解法会失效。

本附录的（A3.1 引言：微分方程的级数解法）目的，就是介绍一个更广义的级数方法——**Frobenius 方法**。这套理论使我们能够：
1.  严格区分“好”点（**常点**）和“坏”点（**奇点**）。
2.  对“奇点”进行分类（**正则** vs **非正则**），以判断其“坏”的程度。
3.  在最重要的“正则奇点”附近，系统地寻找广义级数解 $y(x) = x^r \sum a_n x^n$ 的形式，并解释为何有时必须引入对数项 ($\ln x$)。

这套数学工具是理解勒让德函数、贝塞尔函数、拉盖尔函数等特殊函数结构的基础。

## A3.2 常点、奇点与正则奇点

我们考虑一个一般形式的二阶线性齐次常微分方程（已标准化，即 $y''$ 系数为1）：
$$
y'' + p(x) y' + q(x) y = 0
$$

### 1. 常点 (Ordinary Point)
如果在一个点 $x_0$ 附近，$p(x)$ 和 $q(x)$ 都是**解析函数**（analytic，即可以在 $x_0$ 点展开为收敛的泰勒级数），那么 $x_0$ 就被称为方程的**常点**。

* **解的结构**：在常点 $x_0$ 附近，方程的**所有**解都是解析的。我们可以寻找两个线性无关的泰勒级数解：$y(x) = \sum_{n=0}^{\infty} a_n (x-x_0)^n$。
* **实例**：厄米方程（$y'' - 2xy' + 2\lambda y = 0$）。$p(x)=-2x, q(x)=2\lambda$ 都是多项式，在所有有限点 $x_0$ 处都是解析的。因此，厄米方程在有限复平面上**没有奇点**。

### 2. 奇点 (Singular Point)
如果 $p(x)$ 或 $q(x)$ 中至少有一个在 $x_0$ 点不是解析的（例如发散），那么 $x_0$ 就被称为方程的**奇点**。奇点根据其“恶劣”程度分为两类：

### 3. 正则奇点 (Regular Singular Point, RSP)
一个奇点 $x_0$ 如果满足以下两个“温和”条件，则被称为**正则奇点**：
1.  $(x-x_0) p(x)$ 在 $x_0$ 点是解析的。
2.  $(x-x_0)^2 q(x)$ 在 $x_0$ 点是解析的。

* **直观理解**：这意味着 $p(x)$ 的奇点“坏的程度”不超过 $\frac{1}{x-x_0}$（一阶极点），而 $q(x)$ 的奇点“坏的程度”不超过 $\frac{1}{(x-x_0)^2}$（二阶极点）。
* **解的结构**：在RSP附近，解的行为是可控的（不会有本质奇点）。解的形式由 **Frobenius 方法**（见 A3.4）给出。
* **实例**：
    * **勒让德方程**（$(1-x^2)y'' - 2xy' + \frac{l(l+1)}{1-x^2}y = 0$）：$p(x) = \frac{-2x}{1-x^2}, q(x) = \frac{l(l+1)}{1-x^2}$。 $x=\pm 1$ 是奇点。
        * 在 $x=1$ 处：$(x-1)p(x) = \frac{2x}{1+x}$（解析）；$(x-1)^2q(x) = \frac{-(x-1)l(l+1)}{1+x}$（解析）。
        * 因此 $x=\pm 1$ 都是**正则奇点**。
    * **拉盖尔方程** ($xy'' + (1-x)y' + \lambda y = 0$)：$p(x)=\frac{1-x}{x}, q(x)=\frac{\lambda}{x}$。$x=0$ 是奇点。
        * $x p(x) = 1-x$（解析）；$x^2 q(x) = \lambda x$（解析）。
        * 因此 $x=0$ 是一个**正则奇点**。
    * **贝塞尔方程** ($x^2 y'' + xy' + (x^2 - \nu^2) y = 0$)：$p(x)=\frac{1}{x}, q(x)=\frac{x^2-\nu^2}{x^2}$。$x=0$ 也是一个**正则奇点**。

### 4. 非正则奇点 (Irregular Singular Point, ISP)
如果一个奇点 $x_0$ 不是正则奇点，则称其为**非正则奇点**。

* **解的结构**：在ISP附近，Frobenius 方法失效。解的行为通常是“病态的”，可能包含**本质奇点**（如 $e^{1/x}$），增长或振荡的速度极快。

## A3.3 无穷远点 ($x=\infty$) 的分析

要分析 $x=\infty$ 处的性质，我们进行变量替换 $t = 1/x$，并通过链式法则将原方程转换为一个关于 $t$ 的新方程。然后，我们分析这个**新方程在 $t=0$ 处的奇点类型**。

* **实例**：
    * **厄米方程**：可被证明在 $x=\infty$ 处是一个**非正则奇点**。
    * **拉盖尔方程**：可被证明在 $x=\infty$ 处是一个**非正则奇点**。
    * **勒让德方程**：可被证明在 $x=\infty$ 处是一个**正则奇点**。

* **数学推论**：这解释了为什么厄米方程（谐振子）和拉盖尔方程（氢原子）的无穷级数解在无穷远处会呈 $e^{x^2}$ 或 $e^r$ 这样极快（本质奇点）的发散。

## A3.4 Frobenius 方法与指标方程

Frobenius 定理是处理**正则奇点 (RSP)** 的核心工具。

**定理 (Frobenius 定理)**
> 考虑微分方程 $y'' + p(x) y' + q(x) y = 0$。
> 如果 $x_0 = 0$ 是一个**正则奇点**，
> 
> 那么，该方程在 $x=0$ 附近**至少存在一个**广义幂级数解，形式如下（称为 **Frobenius 级数**）：
> $$
> y(x) = x^r \sum_{n=0}^{\infty} a_n x^n \quad (a_0 \neq 0)
> $$
> 其中 $r$ 是一个（可能是非整数或复数）的常数，称为**指标 (exponent)**。

**指标方程 (Indicial Equation)**
根据RSP的定义， $p(x)$ 和 $q(x)$ 在 $x=0$ 附近可以写为：
* $p(x) = \frac{p_0}{x} + p_1 + p_2 x + \dots$
* $q(x) = \frac{q_0}{x^2} + \frac{q_1}{x} + q_2 + \dots$
其中 $p_0 = \lim_{x \to 0} x p(x)$ 且 $q_0 = \lim_{x \to 0} x^2 q(x)$。

将 $y(x) = \sum a_n x^{n+r}$ 代入原方程 $y'' + p(x) y' + q(x) y = 0$。
收集 $x$ 的**最低次幂项**（即 $n=0$ 时，来自 $y''$ 的 $x^{r-2}$、来自 $p(x)y'$ 的 $\frac{p_0}{x} x^{r-1}$、来自 $q(x)y$ 的 $\frac{q_0}{x^2} x^r$），所有这些项的幂次都是 $x^{r-2}$。
$x^{r-2}$ 项的总系数为：
$$
[r(r-1) a_0 + p_0 r a_0 + q_0 a_0] = 0
$$
因为我们定义了 $a_0 \neq 0$，所以括号内的系数必须为零：
$$
r(r-1) + p_0 r + q_0 = 0
$$
这就是**指标方程**。它的两个根 $r_1, r_2$ 决定了在RSP附近，两个线性无关解的**起始幂次**和**基本结构**。

## A3.5 解的完整结构：三种情况

Frobenius 定理的完整内容说明了如何根据指标方程的两个根 $r_1, r_2$（假设 $\text{Re}(r_1) \ge \text{Re}(r_2)$）来构造**两个**线性无关解。

**情况一：$r_1 - r_2$ 不是整数**
* 总能找到两个独立的 Frobenius 级数解，分别对应 $r_1$ 和 $r_2$：
    * $y_1(x) = x^{r_1} \sum_{n=0}^{\infty} a_n x^n \quad (a_0=1)$
    * $y_2(x) = x^{r_2} \sum_{n=0}^{\infty} b_n x^n \quad (b_0=1)$
* **实例**：贝塞尔方程（当 $\nu$ 不是整数时），$r_1=\nu, r_2=-\nu$。解为 $J_\nu(x)$ 和 $J_{-\nu}(x)$。

**情况二：$r_1 = r_2 = r$ (重根)**
* 只能找到一个 Frobenius 级数解，对应 $r$：
    * $y_1(x) = x^{r} \sum_{n=0}^{\infty} a_n x^n \quad (a_0=1)$
* 第二个线性无关解 $y_2(x)$ **必定**包含一个**对数项**：
    * $y_2(x) = y_1(x) \ln|x| + x^r \sum_{n=1}^{\infty} b_n x^n$
* **实例**：
    * **勒让德方程**：在 $x=1$ 处（令 $t=1-x$），指标方程为 $r(r-1) + (1)r + 0 = 0 \implies r^2=0$，即 $r_1=r_2=0$ (重根)。这严格证明了，在 $x=1$ 附近，一个解 $P_l(x)$ 是解析的（对应 $r=0$ 的级数），而第二个解 $Q_l(x)$ **必须**包含 $\ln(1-x)$ 的对数发散项。
    * **拉盖尔方程**：在 $x=0$ 处，指标方程为 $r(r-1) + (1)r + 0 = 0 \implies r^2=0$ (重根)。因此其解中一个 $L_n(x)$ 是解析的（多项式），而另一个解必定包含 $\ln(x)$。

**情况三：$r_1 - r_2 = N$ ( $N$ 为正整数)**
* 总能找到对应 $r_1$（较大根）的 Frobenius 级数解：
    * $y_1(x) = x^{r_1} \sum_{n=0}^{\infty} a_n x^n \quad (a_0=1)$
* 第二个解 $y_2(x)$ 的一般形式为：
    * $y_2(x) = C y_1(x) \ln|x| + x^{r_2} \sum_{n=0}^{\infty} b_n x^n \quad (b_0=1)$
    * 常数 $C$ **可能为零，也可能非零**。

* 我们可以试探常数 $C$ 的值：
    1.  **尝试**：我们首先尝试 $C=0$，即寻找一个简单的 $y_2 = \sum b_n x^{n+r_2}$ 解。
    2.  **递推关系**：我们会得到一个 $b_n$ 的递推关系，它依赖于 $I(n+r_2) = (n+r_2-r_1)(n+r_2-r_2) = (n-N)n$。
    3.  **关键**：当 $n=N$ 时，这个递推关系的分母 $I(N+r_2) = I(r_1) = 0$。方程在 $n=N$ 这一步的形式变为：
        $$
        0 \cdot b_N + (\text{依赖于 } b_0, ..., b_{N-1} \text{ 的项}) = 0
        $$
    4.  **分析**：
        * **如果 (项) 恰好为 0**：方程变为 $0=0$，$b_N$ 变为一个自由参数。我们成功找到了一个没有对数项的解。此时 $C=0$。
        * **如果 (项) 非 0**：方程变为 $0 = (\text{非零常数})$。这是一个**矛盾**。
    5.  **解决**：这个矛盾告诉我们，最初 $C=0$ 的假设是**错误**的。我们必须使用 $y_2$ 的**完整形式**（$C \neq 0$）。当我们代入完整形式时，在 $n=N$ 这一步，“矛盾”的（非零项）不再等于0，而是被用来**确定 $C$ 的非零值**。
    6.  **实例**：
        * 贝塞尔方程（$\nu=n$ 为正整数）：$r_1=n, r_2=-n$。$r_1-r_2=2n$。这种情况对应 $C \neq 0$。解为 $J_n(x)$ 和 $Y_n(x)$（含 $\ln x$）。
        * 连带拉盖尔方程（$L_n^\alpha(x)$）：$r_1=0, r_2=-\alpha$。如果 $\alpha$ 是正整数，$r_1-r_2=\alpha$。这种情况也对应 $C \neq 0$，第二个解包含对数项。